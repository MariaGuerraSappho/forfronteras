<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>For Fronterras - Musical Pitch Detector</title>
  <!-- Add Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <!-- Import VexFlow for music notation -->
  <script src="https://cdn.jsdelivr.net/npm/vexflow@4.1.0/build/cjs/vexflow.js"></script>
  <!-- Import RecordRTC for recording -->
  <script src="https://cdn.jsdelivr.net/npm/recordrtc@5.6.2/RecordRTC.min.js"></script>
  <!-- Import html2canvas for score export -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
  <div class="app-container">
    <header>
      <img src="logo.png" alt="For Fronterras Logo" width="80">
      <h1>For Fronterras</h1>
    </header>
    
    <main>
      <div class="controls-section">
        <div class="input-controls">
          <label for="mic-select">Select Microphone:</label>
          <select id="mic-select" disabled>
            <option value="">Loading microphones...</option>
          </select>
          <button id="start-btn" class="primary-btn">Start Listening</button>
        </div>
        
        <div class="note-controls">
          <button id="mode-toggle-btn">Switch to Manual Compose</button>
<button id="play-btn" disabled>Play Composition</button>
          <button id="next-note-btn" disabled>Next Note</button>
<button id="stop-btn" disabled>Stop Playback</button>
          <button id="end-btn" class="secondary-btn" disabled>End Session</button>
        </div>
      </div>
      
      <div class="display-section">
        <div class="pitch-display">
          <div class="current-pitch">
            <span id="detected-note">--</span>
            <span id="detected-cents"></span>
          </div>
        </div>
        
        <div class="piano-container">
          <div id="piano-keyboard"></div>
        </div>
        
        <div class="score-container">
          <div id="score-display"></div>
        </div>
      </div>
      
      <div class="export-section" id="export-section" style="display: none;">
        <h2>Session Complete!</h2>
        <div class="export-buttons">
          <button id="download-input-audio-btn" class="export-btn">Download Input Audio</button>
          <button id="download-sine-audio-btn" class="export-btn">Download Sine Audio</button>
          <button id="export-image-btn" class="export-btn">Export Score as Image</button>
          <button id="export-musicxml-btn" class="export-btn">Export as MusicXML</button>
        </div>
      </div>
    </main>
  </div>

  <!-- JavaScript imports -->
  <script type="importmap">
  {
    "imports": {
      "pitch-detector": "./pitch-detector.js",
      "tone-generator": "./tone-generator.js",
      "score-renderer": "./score-renderer.js"
    }
  }
  </script>
  <script type="module" src="app.js"></script>
</body>
</html>
